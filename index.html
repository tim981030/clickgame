<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>game</title>
    <style>
        #b{
            font-size:1vw;
            position:fixed;
            color:blue;
            top:20vh;
            left:50vw;
            height:5vh;
            width:5vw;
            z-index:-10;
            transform:translate(-50%,-50%);
        }
        .st{
            position:fixed;
            display:flex;
            flex-direction:column;
            width:5vw;
            left:48.5vw;
            top:40vh;
            justify-content:center;
            z-index:1;
            pointer-events: none;
        }
        #p{
            position:fixed;
            font-size:1.4vw;
            top:20vh;
            left:47.5vw;
            color:blue;
            z-index:-1;
            transform:translate(-50%,-100%);
            pointer-events: none;
            opacity:0;
            transition:opacity 0.3s ease 0s;
        }
        #m{
            position:fixed;
            font-size:1.4vw;
            top:20vh;
            left:47.5vw;
            color:red;
            z-index:-2;
            transform:translate(-50%,-100%);
            pointer-events: none;
            opacity:0;
            transition:opacity 0.3s ease 0s;
        }
    </style>
</head>
<body>
    <div class="st">
        <h6 id="s">score:0</h6>
        <h6 id="t">time:5s</h6>
    </div>
    <button id="b">start</button>
    <p id="p">PERFECT</p>
    <p id="m">MISS</p>
    <script>
        element=document.querySelector('#b');
        s=document.querySelector('#s');
        t=document.querySelector('#t');
        p=document.querySelector('#p');
        m=document.querySelector('#m');
        let start=false;
        let time=5;
        let score=0;
        let x,y,mx,my;
        function nw(){
            score+=1;
            s.innerText='score:'+score;
            element.style.position='fixed';
            x=(10+Math.random()*80);
            y=(10+Math.random()*80);
            element.style.top=x+'vh';
            element.style.left=y+'vw';
            element.innerText='+'+Math.round(10*(4/score+Math.min(0.3,Math.max(0.1,(70-score)/10))))/10+'s';
        }
        function add(){
            if(flag){
                if(!start){
                start=true;                
                nw();
                time=5;
                element.style.color='black';
                }
                else{
                    nw()
                    if(time<5){time+=0.1}
                    if(time<3){time+=0.1}
                    if(time<2){time+=0.1}
                    if(time<1){time+=0.1}
                    time+=4/score+Math.min(0.3,Math.max(0.1,(70-score)/10));
                };
                ac(p);
            }
            else{
                time-=0.3;
                ac(m);
            }
        }
        function ac(e){
            e.style.left=mx+'px';
            e.style.top=my+'px';
            e.style.opacity='1';
            setTimeout(() => {
                e.style.opacity='0';
            },300);
        }
        
        window.addEventListener('mousemove',function(e){
            mx=e.clientX;
            my=e.clientY;
        })
        let flag=false;
        element.addEventListener('mouseenter',function(){
            flag=true;
        })
        element.addEventListener('mouseleave',function(){
            flag=false;
        })
        element.addEventListener('click',function(){
            add();
        })
        window.addEventListener('keydown',function(){
            add();
        })
        setInterval(function(){
            if(start){
                time-=0.1;
                time=Math.round(time*10)/10;
                t.innerText='time:'+time+'s';
                if(time<0){
                    start=false;
                    element.style.top='20vh';
                    element.style.left='47.5vw';
                    element.innerText='start';
                    element.style.color='blue';
                    alert('You got '+score+' scores');
                    score=0;
                    time=5;
                    s.innerText='score:0';
                    t.innerText='time:5s';
                }
                if(time>=5){t.style.color='black'}
                if(time<5){t.style.color='blue'}
                if(time<3){t.style.color='orange'}
                if(time<1){t.style.color='red'}
            }
        },100)
    </script>
</body>
</html>
